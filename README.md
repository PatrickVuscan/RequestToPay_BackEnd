This is the backend repository for the Scotia Bank project for team Works(*ish*).


# Setup
* To install all of the required packages, run `npm install`
* If you are using WebStorm, you should enable the tslint package and point it to Backend/tslint.json
* Create `.env` and a `schemats.json` files that follow their respective example files. These files have 
    private information in them and cannot be shown in the public git repository.

Necessary in your `.env` File

`DB_CONSTRING=postgres://zcvqkmfmcuyxeh:377a55a83347449b065454395a46a59248e6ba03ced9dfaa3bd403eb3a25ea6d@ec2-174-129-253-104.compute-1.amazonaws.com:5432/dbofdangme5t6r`

- this string may be updated by Heroku 

# Commands
* **Defined in** `package.json`
    * `npm run postinstall`: Hook that is automatically run after npm install.
    * `npm run dev`: Starts a test server that recompiles the application when a file changes.
    * `npm run start`: Starts the production server using `pm2`. Uses `pm2.yaml` for configurations.
    * `npm run test`: Uses `jest` to run tests on the application. Options are defined in `package.json'.
    * `npm run generate-db-types`: Generates typescript types for database objects. Options are in 
        `schemats.json`.
* Other notable commands
    * `pg_dump -U <user> -f schema.sql -s <DBNAME>`: dumps the schema for `<DBNAME>` to a `.sql` file.


# What is this file?
## General files by type
* `*.ts`: Should have a multi-line comment at the top of the file describing its purpose.
    * `*.test.ts`: Files that are tested with 
        [jest](https://basarat.gitbooks.io/typescript/docs/testing/jest.html) by the 
        command `npm run test`.
* `*.example`: An example file of something that would otherwise hold sensitive information. Copy this file
    into another file without the `.example` part and insert the required information before running.
* `src/*`: This is the project directory. There is a specific purpose to each file here. Fore more information
    on each module, refer to the comment at the top of each `index.ts` file.
    * `server.ts`: This is the main file that is run when the server is started.
    * `config`: This is a directory for configurations
    * `middleware`: This is where middleware wrappers go. In general, anything that uses `app.use(...)` 
        should be included here.
    * `services`: This holds services. An example of a service is anything that gets information using an external
        API. Having this allows us to decouple the external API from our own internal API.
        * `*/providers`: This is where the objects that contact external APIs go. This *decouples*
            our code from code that we cannot control.
    * `utils`: Utilities go here. Utils are used by multiple other files, but do not interact with external
        APIs like services might.

## Specific files
* `config/`
    * `swagger.json`: This holds api documentation information that is hosted using the `swagger` package.
    The middleware handler for this can be found in `middleware/apiDocs.ts`.
    * `jestSetup.json`: This is run before any jest test scripts are run. This option is enabled in `package.json`.
* `.env`: This holds environment variables that are inserted using the `dotenv` package.
* `.gitignore`: This holds a list of file patterns that should be ignored when putting files on git.
* `.npmrc`: Makes it so that `npm install` automatically saves packages to `package.json`.
* `package.json`: This specifies required packages, their versions, and various npm scripts.
* `pm2.yaml`: This is used by `npm run start` and describes the behavior of pm2 when the application is started.
* `README.md`: This file.
* `schema.sql`: this can be generated by running the `pg_dump` command described in **Commands** and when run
    in sql, it will generate the Postgres database required for this application. This should be updated every
    every time the database schema is changed.
* `schemats.json`: This file holds configuration info for the npm script `generate-db-types`.
* `TODOs`: This is a list of `TODOs`, as it makes them easier to find and `.json` files do not allow comments.
* `tsconfig.json`: This holds configurations for the typescript compiler. They are fairly strict, as it improves
    code coverage and helps catch bugs without having to write extensive test cases.
* `tslint.json`: This file is used by the tslint package that serves as a style guideline.
